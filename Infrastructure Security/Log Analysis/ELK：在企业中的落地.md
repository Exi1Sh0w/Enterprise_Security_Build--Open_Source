来自t0data师傅的几个关于ELK的问题：

1. 什么场景下使用这个开源组件？
2. 能解决什么样的问题？
3. 产品的兼容性、稳定性、扩展性怎么样？

很多时候写东西的时候容易陷入自己的思维中，所以针对文章的讨论显得格外重要，这些问题同样也不光针对本篇的ELK。

## 概述
### ELK的功能
我们来抄几段话：

* ElasticSearch：是实时全文搜索和分析引擎，提供搜集、分析、存储数据三大功能；是一套开放REST和JAVA API等结构提供高效搜索功能，可扩展的分布式系统。它构建于Apache Lucene搜索引擎库之上。

* Logstash：是一个用来搜集、分析、过滤日志的工具。它支持几乎任何类型的日志，包括系统日志、错误日志和自定义应用程序日志。它可以从许多来源接收日志，这些来源包括syslog、消息传递（例如：RabbitMQ）和JMX，它能够以多种方式输出数据，包括电子邮件、WebSocket和ElasticSearch等。

* Kibana：是一个基于Web的图形界面，用于搜索、分析和可视化存储在ElasticSearch指标中的日志数据。它利用Elasticsearch的REST接口来检索数据，不仅允许用户创建他们自己的数据的定制仪表板视图，还允许他们以特殊的方式查询和过滤数据。

### ELK的优劣对比
* 优点

```
强大的搜索功能：ElasticSearch支持DSL的语法来进行快速搜索，并且支持分布式检索方式。
支持分布式扩展：ElasticSearch与Logstash都支持分布式，可以进行横向扩展，能解决大型集群的很多问题。
完善的展示功能：Kibana支持非常详细的图表信息，同时也可以定制展示内容，实现高效的数据可视化。
简单的基础配置：学习成本低，能够满足查询秒级响应。
```

* 缺点

```
需要投入人力进行运营：运营成本。
数据的安全性保障较低，因为针对认证的Xpack模块是收费的，传输安全可以通过配置SSL来保障。
数据关联分析效果较差：目前在ELK中实现关联分析是比较难的。
```

### ELK的架构分析
* ElasticSearch+Logstash+Kibana

概述：由Logstash分布于各个节点上搜集相关日志、数据，并经过分析、过滤后发送给远端服务器上的Elasticsearch进行存储。Elasticsearch将数据以分片的形式压缩存储并提供多种API供用户查询，操作。

优点：搭建简单、易于上手。

缺点：Logstash消耗资源较大，运行占用CPU和内存高，没有消息队列缓存，存储数据丢失隐患。

适用场景：小规模集群或者学习者使用

* 引入消息队列

概述：引入消息队列机制，位于各个节点上的Logstash Agent先将数据传递到Kafka或Redis，并将队列中消息或数据间接传递给Logstash Server，Logstash Server分析、过滤后将数据传递给ES存储。

优点：引入消息队列机制，即使Logstash Server因故障停止运行，数据将会先被消息队列存储下来，从而避免数据丢失

缺点：由于Logstash中心节点和ES的负荷会比较重，可将它们配置为集群模式，以分担负荷

适用场景：较大集群的解决方案

* 引入Logstash-Forwarder

概述：引入Logstash-Forwarder，首先Logstash-Forwarder将日志数据统一发送给Logstash，经过分析、过滤后发送到ES进行存储。

优点：解决了Logstash在各机器上占用系统资源较高的问题，Logstash-Forwarder与Logstash之间的通信是通过SSL加密传输，起到安全保障

缺点：由于SSL加密传输导致的限制性

* 引入Beats

### ELK适用于什么场景
用于进行日志分析：包括用户行为日志、Web日志、服务器安全日志、防火墙或其他安全设备日志等。

当我们需要解决如下问题的时候，都是ELK的适用场景：

```
日志收集、处理、分析、展示
程序运行问题排查
服务器性能监控、应用监控、安全监控、错误报警
用户行为分析、漏洞分析等等
```
